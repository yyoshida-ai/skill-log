<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新卒ディレクター成長ログ (クラウド同期版)</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #f8fafc; }
        .lucide { width: 1em; height: 1em; display: inline-block; vertical-align: middle; stroke-width: 2; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // ==========================================
        // 【ここを書き換えてください】
        // ==========================================
        const BIN_ID = "6983283bae596e708f105d93"; // あなたのIDを入れました
        const MASTER_KEY = "$2a$10$q4bNG0bRY3SEdnb8XumWLOwYdF4nwiO2oLU90SEn18OIKQ9cxICii"; 
        // ==========================================

        const Icons = {
            Briefcase: (props) => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>,
            CheckCircle2: (props) => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>,
            Circle: (props) => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/></svg>,
            Cloud: (props) => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M17.5 19c2.5 0 4.5-2 4.5-4.5 0-2.3-1.7-4.2-4-4.5A7 7 0 1 0 5 13c0 .1 0 .2.1.3A5 5 0 0 0 6 22h11.5Z"/></svg>
        };

        const defaultSkills = [
            { id: 101, category: "Business", theme: "基礎スキル", label: "電話対応：企業名・要件を聞き取り正しく取り取り次げる", month: 1 },
            { id: 102, category: "Business", theme: "基礎スキル", label: "メール対応：ビジネスマナーに則った返信ができる", month: 1 },
            { id: 103, category: "Business", theme: "ツール活用", label: "Slack：メンションを使い分け適切に連絡できる", month: 1 },
            // ... (他のデータも同様にここに入ります)
        ];

        const App = () => {
            const [completedIds, setCompletedIds] = useState([]);
            const [isSyncing, setIsSyncing] = useState(false);
            const [isLoaded, setIsLoaded] = useState(false);

            // 1. 初回起動時にクラウドからデータを読み込む
            useEffect(() => {
                fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
                    headers: { 'X-Master-Key': MASTER_KEY }
                })
                .then(res => res.json())
                .then(data => {
                    if (data.record && data.record.completedIds) {
                        setCompletedIds(data.record.completedIds);
                    }
                    setIsLoaded(true);
                })
                .catch(err => {
                    console.error("読み込みエラー:", err);
                    setIsLoaded(true);
                });
            }, []);

            // 2. データをクラウドに保存する
            const saveToCloud = (newIds) => {
                setIsSyncing(true);
                fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': MASTER_KEY
                    },
                    body: JSON.stringify({ completedIds: newIds })
                })
                .then(() => {
                    setTimeout(() => setIsSyncing(false), 500);
                })
                .catch(err => {
                    console.error("保存エラー:", err);
                    setIsSyncing(false);
                });
            };

            const toggleComplete = (id) => {
                const nextIds = completedIds.includes(id) 
                    ? completedIds.filter(i => i !== id) 
                    : [...completedIds, id];
                setCompletedIds(nextIds);
                saveToCloud(nextIds); // 変更のたびに保存
            };

            if (!isLoaded) return <div className="flex h-screen items-center justify-center">同期中...</div>;

            return (
                <div className="max-w-2xl mx-auto p-6">
                    <header className="flex justify-between items-center mb-8 bg-white p-4 rounded-xl shadow-sm border">
                        <h1 className="text-xl font-bold flex items-center gap-2">
                            <Icons.Briefcase className="text-blue-600" /> 成長ログ
                        </h1>
                        <div className={`flex items-center gap-2 text-xs ${isSyncing ? 'text-blue-500' : 'text-green-500'}`}>
                            <Icons.Cloud size={16} className={isSyncing ? 'animate-pulse' : ''} />
                            {isSyncing ? '同期中...' : 'クラウド保存済み'}
                        </div>
                    </header>

                    <div className="space-y-3">
                        {defaultSkills.map(skill => (
                            <div 
                                key={skill.id}
                                onClick={() => toggleComplete(skill.id)}
                                className={`p-4 rounded-lg border cursor-pointer transition-all flex items-center gap-3 ${completedIds.includes(skill.id) ? 'bg-blue-50 border-blue-200' : 'bg-white hover:bg-gray-50'}`}
                            >
                                <div className={completedIds.includes(skill.id) ? 'text-blue-600' : 'text-gray-300'}>
                                    {completedIds.includes(skill.id) ? <Icons.CheckCircle2 fill="currentColor" className="text-blue-600 fill-blue-100" /> : <Icons.Circle />}
                                </div>
                                <div>
                                    <div className="text-xs text-gray-400 font-bold">{skill.theme}</div>
                                    <div className={`text-sm ${completedIds.includes(skill.id) ? 'text-gray-400 line-through' : 'text-gray-800'}`}>{skill.label}</div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>